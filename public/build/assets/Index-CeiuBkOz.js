import{_ as xe}from"./AppLayout-BZcXL0MU.js";import{o as l,e as m,a as e,d as h,i as J,F as D,g as F,n as O,h as S,t as M,b as B,f as ee,j as I,v as X,B as Y,w as U,E as ye,G as Q,s as V,c as E,A as Z,l as K,k as L,u as we,p as he}from"./app-CGrFRThM.js";import{u as oe}from"./store-CiEZvh8G.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{I as le}from"./InputNumber-Bvu0TAUN.js";import"./IconCofingBranco-b62jRgVI.js";const _e={},$e={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",style:{fill:"rgba(8, 118, 178, 1)",transform:"0",msfilter:""}};function Ce(f,o){return l(),m("div",null,[(l(),m("svg",$e,o[0]||(o[0]=[e("path",{d:"M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm3.293 14.707L11 12.414V6h2v5.586l3.707 3.707-1.414 1.414z"},null,-1)])))])}const Me=q(_e,[["render",Ce]]),ke={class:"card"},Pe={class:"card-body"},Se={class:"grid grid-cols-5 gap-4"},je=["onClick"],Ae={class:"flex-1 p-4"},Ve={class:"flex items-center justify-between"},Ie={class:"flex items-center"},Be={key:0,xmlns:"http://www.w3.org/2000/svg",class:"w-6 h-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},qe={key:1,xmlns:"http://www.w3.org/2000/svg",class:"w-6 h-6 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},Le={key:2,xmlns:"http://www.w3.org/2000/svg",class:"w-6 h-6 text-yellow-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},Ee={key:3,xmlns:"http://www.w3.org/2000/svg",class:"w-6 h-6 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},Te={class:"mt-4"},ze={class:"mt-2 font-medium text-gray-800 text-lg font-semibold"},De={key:0,class:"flex items-center justify-between mt-2"},Oe={class:"text-gray-500 font-semibold text-md"},Fe={class:"flex items-center font-semibold text-gray-500 text-sm"},Ne={__name:"MesaComponent",setup(f,{emit:o}){const d=o,n=oe(),r=h([]),v=async()=>{try{const u=await I.get("/api/mesas/listar");u.data.success?r.value=u.data.data:console.error("Falha ao carregar mesas")}catch(u){console.error("Erro ao buscar mesas:",u)}};J(()=>{v()});const a=u=>{u.status==="livre"?u.status="em_espera":u.status==="em_espera"?(p(u),d("mesa-click",{id:u.id,nome:u.nome}),n.openSalesPanel({mesa:u})):u.status==="aberto"?(d("mesa-click",{id:u.id,nome:u.nome}),n.openSalesPanel({mesa:u})):u.status==="pendente"&&(d("mesa-click",{id:u.id,nome:u.nome}),n.openSalesPanel({mesa:u}))},p=async u=>{try{await I.post(`/mesas/${u.id}/abrir`),u.status="aberto",n.openSalesPanel({mesa:u})}catch(b){console.error("Erro ao abrir a mesa:",b)}};return(u,b)=>(l(),m("div",ke,[e("div",Pe,[e("div",Se,[(l(!0),m(D,null,F(r.value,x=>(l(),m("div",{class:"flex bg-slate-50 shadow-md rounded-lg overflow-hidden cursor-pointer",key:x.id,onClick:C=>a(x)},[e("div",{class:O({"w-2 bg-green-500":x.status==="aberto","w-2 bg-yellow-500":x.status==="em_espera","w-2 bg-blue-500":x.status==="pendente","w-2 bg-gray-400":x.status==="livre"})},null,2),e("div",Ae,[e("div",Ve,[e("div",Ie,[x.status==="livre"?(l(),m("svg",Be,b[0]||(b[0]=[e("path",{d:"M5 12h14M12 5v14","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]))):x.status==="aberto"?(l(),m("svg",qe,b[1]||(b[1]=[e("path",{d:"M9 12l2 2 4-4","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]))):x.status==="em_espera"?(l(),m("svg",Le,b[2]||(b[2]=[e("path",{d:"M12 6v6h6","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]))):x.status==="pendente"?(l(),m("svg",Ee,b[3]||(b[3]=[e("path",{d:"M16.24 7.76a6 6 0 11-8.48 8.48 6 6 0 018.48-8.48z"},null,-1),e("path",{d:"M12 8v4l2 2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]))):S("",!0)]),e("div",{class:O([{"text-green-500":x.status==="aberto","text-yellow-500":x.status==="em_espera","text-blue-500":x.status==="pendente","text-gray-400":x.status==="livre"},"text-sm font-bold"])},M(x.status==="aberto"?"Aberto":x.status==="em_espera"?"Clique para abrir":x.status==="pendente"?"Pendente":"Livre"),3)]),e("div",Te,[e("span",ze,M(x.nome),1)]),x.venda?(l(),m("div",De,[e("div",Oe,M(x.venda.valor_total_formatado),1),e("div",Fe,[B(Me),ee(" "+M(x.venda.tempo_aberta),1)])])):S("",!0)])],8,je))),128))])])]))}},Re=q(Ne,[["__scopeId","data-v-a6b28581"]]),Ue={class:"relative mb-1 w-full"},He={__name:"SearchBar",emits:["search"],setup(f,{emit:o}){const d=h(""),n=o,r=()=>{n("search",d.value)};return(v,a)=>(l(),m("div",Ue,[X(e("input",{"onUpdate:modelValue":a[0]||(a[0]=p=>d.value=p),type:"text",placeholder:"Busca por nome ou código de barras...",class:"border border-gray-300 rounded-lg w-full p-3 pl-12 pr-4 text-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-300 ease-in-out",onInput:r},null,544),[[Y,d.value]]),a[1]||(a[1]=e("i",{class:"fa-solid fa-search absolute left-5 top-1/2 transform -translate-y-1/2 text-gray-500"},null,-1))]))}},We=q(He,[["__scopeId","data-v-99cf195f"]]),Ge={class:"overflow-x-scroll h-[18%]"},Qe={class:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-11 gap-1"},Je=["onClick"],Xe=["src"],Ye={class:"text-sm mt-1 text-center font-semibold text-gray-700 hover:text-blue-900 transition-colors"},Ze=["onClick"],Ke={key:0,class:"absolute top-2 right-2 flex items-center justify-center w-6 h-6 bg-blue-500 text-white text-xs rounded-full border-2 border-white"},et=["src"],tt={class:"text-sm font-semibold text-gray-800 text-center mb-1"},st={class:"text-sm font-medium text-gray-600"},at={key:0,class:"text-center mt-6 text-gray-500"},ot={__name:"ProductList",props:{categories:{type:Array,required:!0},cartItems:{type:Array,required:!0}},emits:["add-to-cart"],setup(f,{emit:o}){const d=f,n=o,r=s=>n("add-to-cart",s),v=h([]),a=h(null),p=h(null),u=h(!1),b=h(""),x=h(null),C=s=>(s*100/100).toFixed(2).replace(".",","),_=async()=>{u.value=!0;try{const s={category:p.value,search:b.value,per_page:30},c=await I.get("/api/products",{params:s}),w=c.data.data;v.value=w.filter(P=>{const A=!p.value||P.category_id===p.value,H=!b.value||P.name.toLowerCase().includes(b.value.toLowerCase())||P.barcode&&P.barcode.toLowerCase().includes(b.value.toLowerCase());return H&&P.barcode&&P.barcode.toLowerCase()===b.value.toLowerCase()&&(r(P),b.value=""),A&&H}),a.value=c.data.next_page_url}catch(s){console.error("Erro ao filtrar produtos:",s)}finally{u.value=!1}},y=s=>{b.value=s,x.value&&clearTimeout(x.value),x.value=setTimeout(async()=>{await _()},200)},k=async s=>{p.value=p.value===s?null:s,await _()},j=s=>{const c=d.cartItems.find(w=>w.id===s);return c?c.quantity:0},T=async()=>{if(!(u.value||!a.value)){u.value=!0;try{const s=await I.get(a.value);s&&s.data&&s.data.data&&(v.value.push(...s.data.data),a.value=s.data.next_page_url)}catch(s){console.error("Erro ao carregar mais produtos:",s)}finally{u.value=!1}}},z=s=>{const{scrollTop:c,scrollHeight:w,clientHeight:P}=s.target;c+P>=w-50&&T()};return J(async()=>{u.value=!0;try{const s=await I.get("/api/products",{params:{per_page:30}});v.value=s.data.data,a.value=s.data.next_page_url}catch(s){console.error("Erro ao carregar produtos:",s)}finally{u.value=!1}}),(s,c)=>(l(),m(D,null,[e("div",Ge,[e("div",Qe,[(l(!0),m(D,null,F(f.categories,w=>(l(),m("div",{key:w.id,class:"flex flex-col items-center justify-center cursor-pointer transform transition-transform hover:scale-105 overflow-y-auto",onClick:P=>k(w.id)},[e("div",{class:O(["w-16 h-16 rounded-full flex items-center justify-center bg-white shadow-xl transform transition-transform hover:scale-110 select-none",{"bg-blue-900":p.value===w.id}])},[e("img",{src:`/storage/${w.image_path||"default-product-image.jpg"}`,alt:"Categoria",class:"w-full h-full rounded-full object-cover"},null,8,Xe)],2),e("p",Ye,M(w.name),1)],8,Je))),128))])]),B(We,{class:"p-1 mt-2",onSearch:y}),e("div",{class:"overflow-y-auto mt-4 flex-grow p-2",onScroll:z},[B(ye,{name:"product-fade",tag:"div",class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-2"},{default:U(()=>[(l(!0),m(D,null,F(v.value,w=>(l(),m("div",{key:w.id,class:"bg-white shadow-xl rounded-lg p-4 flex flex-col items-center justify-between relative overflow-hidden transform transition-transform hover:scale-105 hover:shadow-2xl cursor-pointer select-none",onClick:P=>r(w)},[j(w.id)>0?(l(),m("div",Ke,M(j(w.id)),1)):S("",!0),e("img",{src:`/storage/${w.image_path||"default-product-image.jpg"}`,alt:"Produto",class:"object-cover w-16 h-16 rounded-md mb-3 transition-transform duration-200 transform hover:scale-110"},null,8,et),e("p",tt,M(w.name),1),e("p",st," R$ "+M(C(w.price)),1)],8,Ze))),128))]),_:1}),u.value?(l(),m("div",at," Carregando... ")):S("",!0)],32)],64))}},lt=q(ot,[["__scopeId","data-v-a1edfd42"]]),ae={success(f,o={}){Q().success(f,o)},error(f,o={}){Q().error(f,o)},info(f,o={}){Q().info(f,o)},warning(f,o={}){Q().warning(f,o)}},nt={class:"fixed inset-0 flex items-center justify-center bg-gray-900"},rt={class:"bg-white p-6 rounded-md shadow-md text-center"},it={class:"flex justify-between mt-4"},dt={__name:"DiscountModal",props:{cartTotal:{type:Number,required:!0}},emits:["close","apply-discount"],setup(f,{emit:o}){const d=h(0),n=f,r=o,v=()=>{if(!n.cartTotal||n.cartTotal<=0){ae.error("Carrinho vazio, não é possível aplicar desconto.");return}const a=parseInt(d.value)||0;a>0&&a<=n.cartTotal?(r("apply-discount",a),r("close")):ae.warning("Desconto inválido ou maior que o total do carrinho.")};return(a,p)=>(l(),m("div",nt,[e("div",rt,[p[2]||(p[2]=e("h2",{class:"text-lg font-semibold mb-4"},"Aplicar Desconto",-1)),p[3]||(p[3]=e("p",null,"Insira o valor do desconto:",-1)),B(le,{modelValue:d.value,"onUpdate:modelValue":p[0]||(p[0]=u=>d.value=u),type:"number",min:"0",class:"border w-full mt-2",placeholder:"Ex: 10,00"},null,8,["modelValue"]),e("div",it,[e("button",{onClick:p[1]||(p[1]=u=>a.$emit("close")),class:"bg-gray-300 px-4 py-2 text-gray-700 rounded-lg hover:bg-gray-300"}," Cancelar "),e("button",{onClick:v,class:"bg-green-500 text-white px-4 py-2 rounded-md"}," Aplicar ")])])]))}},ut=q(dt,[["__scopeId","data-v-aafbd954"]]),ct={class:"fixed inset-0 flex items-center justify-center bg-gray-900"},mt={class:"bg-white p-6 rounded-md shadow-md text-center"},vt={class:"flex justify-between mt-4"},ft={__name:"AddValueModal",emits:["close","apply-value"],setup(f,{emit:o}){const d=h(0),n=()=>{const v=parseFloat(d.value)||0,a=v/100;v>=0&&(r("apply-value",a),r("close"))},r=o;return(v,a)=>(l(),m("div",ct,[e("div",mt,[a[2]||(a[2]=e("h2",{class:"text-lg font-semibold mb-4"},"Adicionar Valor",-1)),a[3]||(a[3]=e("p",null,"Insira o valor a ser adicionado:",-1)),B(le,{modelValue:d.value,"onUpdate:modelValue":a[0]||(a[0]=p=>d.value=p),type:"number",min:"0",class:"border w-full mt-2",placeholder:"Ex: 10,00"},null,8,["modelValue"]),e("div",vt,[e("button",{onClick:a[1]||(a[1]=p=>v.$emit("close")),class:"bg-gray-300 px-4 py-2 text-gray-700 rounded-lg hover:bg-gray-300"}," Cancelar "),e("button",{onClick:n,class:"bg-green-500 text-white px-4 py-2 rounded-md"}," Adicionar ")])])]))}},pt=q(ft,[["__scopeId","data-v-4d3237e7"]]),gt={class:"fixed inset-0 payment-methods bg-modal flex items-center justify-center p-4"},bt={class:"bg-white p-6 rounded-lg shadow-lg w-full max-w-xl transform transition-all duration-300 ease-in-out animate-modal"},xt={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 mb-6"},yt=["disabled","onClick"],wt={class:"mb-6"},ht={class:"text-sm text-gray-600 flex-1 truncate"},_t=["onUpdate:modelValue","onBlur"],$t=["onClick"],Ct={class:"text-sm mb-6"},Mt={class:"flex justify-between font-semibold mb-2 text-gray-700"},kt={class:"flex justify-between font-semibold mb-2 text-green-500"},Pt={class:"flex justify-between font-semibold mb-2 text-yellow-500"},St={class:"flex justify-between font-bold text-lg text-gray-800"},jt={key:0,class:"text-green-600 font-semibold mt-2"},At={class:"flex justify-between mt-6"},Vt=["disabled"],It={__name:"PaymentMethods",props:{subtotal:{type:Number,default:0},addedValue:{type:Number,default:0},discountValue:{type:Number,default:0}},emits:["save-payments","close"],setup(f,{emit:o}){const d=o,n=h([]),r=h({}),v=h({}),a=h(""),p=f,u=async()=>{try{const s=await I.get("/api/paymentMethod");n.value=s.data.map(c=>({id:c.id,name:c.id.toString(),label:c.name})),console.log(n.value)}catch(s){console.error("Erro ao carregar métodos de pagamento:",s)}};J(()=>{u()});const b=s=>{if(!r.value[s.name]&&y.value>0){const c=y.value;r.value[s.name]=c,v.value[s.name]=j(c),a.value=s.name}},x=s=>{delete r.value[s],delete v.value[s],a.value=null},C=s=>{const c=T(v.value[s]),w=y.value+(r.value[s]||0);r.value[s]=Math.min(c,w),v.value[s]=j(r.value[s])},_=s=>{const c=n.value.find(w=>w.name===s);return c?c.label:s},y=V(()=>{const s=Object.values(r.value).reduce((c,w)=>c+w,0);return Math.max(p.subtotal+p.addedValue-p.discountValue-s,0)}),k=s=>!!r.value[s]||y.value<=0,j=s=>(s/100).toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),T=s=>{const c=s.replace(/[^0-9,]/g,"").replace(",",".");return Math.round(parseFloat(c)*100)||0},z=()=>{console.log("paymentValues antes de emitir:",r.value);const s=Object.keys(r.value).map(c=>({name:c,amount:r.value[c]}));if(!Array.isArray(s)){console.error("methods não é um array:",s);return}d("save-payments",{methods:s,totalPaid:p.subtotal+p.addedValue-p.discountValue}),d("close")};return(s,c)=>(l(),m("div",gt,[e("div",bt,[c[7]||(c[7]=e("h3",{class:"text-xl font-bold mb-6 text-gray-800 text-center"}," Adicionar Forma de Pagamento ",-1)),e("div",xt,[(l(!0),m(D,null,F(n.value,w=>(l(),m("button",{key:w.name,disabled:k(w.name),class:O(["py-2 px-4 rounded-md text-sm font-medium transition-colors duration-200",a.value===w.name?"bg-blue-600 text-white":"bg-gray-200 text-gray-700",k(w.name)?"opacity-50 cursor-not-allowed":""]),onClick:P=>b(w)},M(w.label),11,yt))),128))]),e("div",wt,[c[2]||(c[2]=e("h4",{class:"text-sm font-semibold text-center mb-2 text-gray-700"}," Pagamentos Adicionados ",-1)),e("ul",null,[(l(!0),m(D,null,F(r.value,(w,P)=>(l(),m("li",{key:P,class:"flex items-center justify-between bg-gray-100 p-3 rounded-md mb-3 shadow-sm"},[e("span",ht,M(_(P))+": ",1),X(e("input",{"onUpdate:modelValue":A=>v.value[P]=A,onBlur:A=>C(P),type:"text",class:"border border-gray-300 rounded-md w-28 text-right py-1 px-2 text-sm"},null,40,_t),[[Y,v.value[P]]]),e("button",{class:"text-red-600 hover:text-red-700 ml-4",onClick:A=>x(P)},c[1]||(c[1]=[e("i",{class:"fa-solid fa-trash"},null,-1)]),8,$t)]))),128))])]),e("div",Ct,[e("div",Mt,[c[3]||(c[3]=e("span",null,"Subtotal:",-1)),e("span",null,M(j(f.subtotal)),1)]),e("div",kt,[c[4]||(c[4]=e("span",null,"Acréscimo:",-1)),e("span",null,M(j(f.addedValue)),1)]),e("div",Pt,[c[5]||(c[5]=e("span",null,"Desconto:",-1)),e("span",null,M(j(f.discountValue)),1)]),e("div",St,[c[6]||(c[6]=e("span",null,"Restante:",-1)),e("span",null,M(j(y.value)),1)]),y.value===0?(l(),m("div",jt," Pagamento completo! ")):S("",!0)]),e("div",At,[e("button",{class:"bg-gray-300 hover:bg-gray-400 text-gray-700 font-semibold py-2 px-4 rounded-md w-full mr-2",onClick:c[0]||(c[0]=w=>s.$emit("close"))}," Cancelar "),e("button",{class:"bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-md w-full",onClick:z,disabled:y.value!==0}," Salvar pagamento ",8,Vt)])])]))}},Bt=q(It,[["__scopeId","data-v-cc9f0c97"]]),qt={class:"modal-overlay"},Lt={__name:"ConfirmModal",emits:["confirm","close"],setup(f,{emit:o}){const d=o,n=()=>{d("confirm"),d("close")},r=()=>{d("close")};return(v,a)=>(l(),m("div",qt,[e("div",{class:"modal-content"},[a[0]||(a[0]=e("p",{class:"text-lg font-bold"},"Tem certeza que deseja Salvar a venda?",-1)),e("div",{class:"mt-4 flex justify-between"},[e("button",{onClick:n,class:"bg-green-500 text-white p-2 w-full mr-2 rounded"}," Sim "),e("button",{onClick:r,class:"bg-red-500 text-white w-full p-2 rounded"}," Não ")])])]))}},Et=q(Lt,[["__scopeId","data-v-409a3271"]]),Tt={class:"modal-overlay"},zt={__name:"ConfirmModalPagamento",emits:["confirm","close"],setup(f,{emit:o}){const d=o,n=()=>{d("confirm"),d("close")},r=()=>{d("close")};return(v,a)=>(l(),m("div",Tt,[e("div",{class:"modal-content"},[a[0]||(a[0]=e("h2",{class:"text-xl font-bold text-gray-800 mb-4"},"Confirmação",-1)),a[1]||(a[1]=e("p",{class:"text-gray-600 text-base"}," Tem certeza que deseja finalizar a venda? ",-1)),e("div",{class:"mt-6 flex justify-center space-x-4"},[e("button",{onClick:n,class:"bg-green-600 hover:bg-green-700 text-white font-medium px-6 py-2 rounded shadow-md transition-transform transform hover:scale-105"}," Sim "),e("button",{onClick:r,class:"bg-red-600 hover:bg-red-700 text-white font-medium px-6 py-2 rounded shadow-md transition-transform transform hover:scale-105"}," Não ")])])]))}},Dt=q(zt,[["__scopeId","data-v-d7292907"]]),Ot={key:0,class:"fixed inset-0 z-50 bg-gray-900 bg-opacity-50 flex justify-center items-center"},Ft={class:"bg-white p-6 rounded-lg shadow-xl w-96 max-w-sm relative"},Nt={class:"mb-4 text-gray-600 text-center"},Rt={class:"flex items-center mb-4"},Ut={class:"flex items-center w-2/3"},Ht={__name:"ProductEditModal",props:{isVisible:{type:Boolean,required:!0},product:{type:Object,required:!0}},setup(f,{emit:o}){const d=f,n=o,r=h(d.product.quantity),v=()=>{n("close")},a=()=>{n("apply",{...d.product,quantity:r.value}),n("close")},p=()=>{n("remove",d.product.id),n("close")};return(u,b)=>f.isVisible?(l(),m("div",Ot,[e("div",Ft,[e("button",{onClick:v,class:"absolute top-4 right-4 text-gray-600 hover:text-gray-800 transition"}," × "),b[3]||(b[3]=e("h3",{class:"text-xl font-semibold mb-4 text-center"},"Editar Produto",-1)),e("p",Nt,M(f.product.name),1),e("div",Rt,[b[2]||(b[2]=e("label",{class:"text-gray-600 font-medium w-1/3"},"Quantidade",-1)),e("div",Ut,[X(e("input",{type:"number","onUpdate:modelValue":b[0]||(b[0]=x=>r.value=x),min:"1",class:"border p-2 rounded w-20 text-center"},null,512),[[Y,r.value]]),e("button",{onClick:p,class:"ml-2 text-red-500 hover:text-red-700"},b[1]||(b[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])]),e("button",{onClick:a,class:"w-full bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition"}," Aplicar ")])])):S("",!0)}},Wt=q(Ht,[["__scopeId","data-v-ac1ee0d8"]]),Gt={class:"h-96 overflow-y-scroll mt-3 flex-grow"},Qt={key:0,class:"bg-yellow-400 mb-2 text-center font-bold text-gray-100"},Jt={class:"flex flex-col space-y-2 font-semibold"},Xt=["onClick"],Yt={class:"mr-2"},Zt={class:"w-7 h-7 rounded-lg bg-blue-400 flex items-center justify-center text-white"},Kt={class:"text-gray-500 flex-grow font-weight-bold"},es={class:"flex items-center space-x-2 flex-shrink-0"},ts={class:"text-gray-500 font-weight-bold"},ss={__name:"Cart",props:{formattedCartItems:{type:Array,required:!0}},setup(f,{emit:o}){const d=C=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(C/100),n=f,r=o,v=h(!1),a=h(null),p=V(()=>n.formattedCartItems.map(C=>{const _=C.totalPrice||0,y=d(_);return{...C,totalPriceFormatted:y,formattedPrice:y}})),u=C=>{a.value=C,v.value=!0},b=C=>{const _=n.formattedCartItems.findIndex(y=>y.id===C.id);_!==-1&&(n.formattedCartItems[_]=C,r("updateCart",n.formattedCartItems))},x=C=>{const _=n.formattedCartItems.filter(y=>y.id!==C);r("updateCart",_)};return(C,_)=>(l(),m("div",Gt,[p.value.length>0?(l(),m("div",Qt," NOVOS ")):S("",!0),e("div",Jt,[(l(!0),m(D,null,F(p.value,y=>(l(),m("div",{key:y.id,class:"flex items-center pb-1 mb-1 cursor-pointer",onClick:k=>u(y)},[e("div",Yt,[e("p",Zt,M(y.quantity),1)]),e("p",Kt,M(y.name),1),e("div",es,[e("p",ts,M(y.formattedPrice),1)])],8,Xt))),128))]),v.value?(l(),E(Wt,{key:1,product:a.value,isVisible:v.value,onClose:_[0]||(_[0]=y=>v.value=!1),onApply:b,onRemove:x},null,8,["product","isVisible"])):S("",!0)]))}},as={key:0,class:"modal-wrapper"},os={class:"content-wrapper"},ls={class:"bg-blue-100 grid grid-cols-1 lg:grid-cols-[450px_auto] gap-1"},ns={class:"bg-white shadow-sm rounded-lg p-2 flex flex-col h-full"},rs={class:"flex items-center space-x-3 shadow-sm p-1 mb-2"},is={class:"text-xl font-bold text-sky-500"},ds={class:"flex justify-end flex-grow"},us={key:0,class:"loading-overlay"},cs={class:"p-2 mb-2"},ms={class:"text-gray-600 flex justify-between"},vs={class:"font-semibold text-gray-600"},fs={class:"text-gray-600 flex justify-between"},ps={class:"font-semibold text-gray-600 text-warning"},gs={class:"text-gray-800 flex justify-between"},bs={class:"font-semibold text-xl text-gray-800"},xs={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-1"},ys={key:1},ws={key:2,class:"flex space-x-2 mt-6"},hs={class:"bg-white shadow-sm rounded-lg p-2 flex flex-col h-[calc(100vh)]"},_s={key:0,class:"fixed inset-0 z-50 bg-gray-900 bg-opacity-50 flex justify-center items-center"},$s={class:"bg-white p-8 rounded-lg shadow-xl w-96 max-w-sm transform transition-all duration-300 ease-in-out animate-modal"},Cs={class:"flex justify-between"},Ms={key:0,class:"fixed inset-0 z-50 bg-gray-900 bg-opacity-50 flex justify-center items-center"},ks={class:"bg-white p-8 rounded-lg shadow-xl w-96 max-w-sm transform transition-all duration-300 ease-in-out animate-modal"},Ps={class:"flex justify-between"},Ss={__name:"SalesPanel",props:{MesaSelecionada:{type:Object,required:!0},products:{type:Object,required:!0},categories:{type:Array,required:!0},filters:{type:Object,required:!0}},setup(f,{emit:o}){const d=oe(),n=o,r=V(()=>d.isSalesPanelVisible),v=h(!1),a=h(!1),p=h(!1),u=h(!1),b=h(!1),x=h(0),C=h(0),_=h(0),y=h(!1),k=h([]),j=h([]),T=h(!1),z=h(!1),s=V(()=>{var i;return((i=A.MesaSelecionada)==null?void 0:i.id)||null}),c=V(()=>{var i;return((i=A.MesaSelecionada)==null?void 0:i.nome)||"Sem Nome"}),w=i=>{if(Array.isArray(i.methods)){j.value=i.methods;const t=i.methods.reduce(($,be)=>$+be.amount,0),g=R.value;_.value=g-t,_.value<=0&&(_.value=0),ce()}else console.error("selectedPayments.methods não é um array:",i.methods)},P=i=>{k.value=i},A=f;Z(()=>A.mesaId,i=>{i&&console.log(`Mesa ID mudou para: ${i}`)}),Z(r,i=>{i&&A.MesaSelecionada.id&&H(A.MesaSelecionada.id)});const H=async i=>{try{y.value=!0;const t=await I.get(`/api/vendas/${i}`);if(t.data.success){const g=t.data.venda;k.value=g.produtos.map($=>({id:$.product_id,name:$.nome,quantity:$.quantidade,totalPrice:$.valor_total/100*100})),j.value=g.pagamentos.map($=>({method:$.metodo,amount:$.valor/100*100})),C.value=g.desconto/100*100,x.value=g.acrescimo/100*100,_.value=g.valor_total/100*100-R.value}else console.error("Essa mesa ainda não foi salva!")}catch{console.error("Essa mesa ainda não foi salva!")}finally{y.value=!1}},W=()=>{b.value=!1,ne(),n("updateMesa"),d.closeSalesPanel()},ne=()=>{k.value=[],j.value=[],x.value=0,C.value=0},re=i=>{const t=Math.round(parseFloat(i.price)*100)||0,g=k.value.find($=>$.id===i.id);g?(g.quantity+=1,g.totalPrice+=t):k.value.push({id:i.id,name:i.name,quantity:1,totalPrice:t})},ie=i=>{const t=Math.round(parseFloat(i)*100),$=(t>=0?t:0)/100;C.value=$},de=i=>{x.value=Math.round(parseFloat(i)*100)},N=i=>(i/100).toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),ue=async()=>{var t,g;const i={mesaId:A.MesaSelecionada.id,products:k.value,total:R.value};try{(await I.post("/api/vendas/salvar",i)).data.success&&(L.success("Venda salva com sucesso!"),W())}catch($){L.error(((g=(t=$.response)==null?void 0:t.data)==null?void 0:g.message)||"Erro ao salvar a venda.")}},ce=async()=>{var t,g;const i={mesaId:A.MesaSelecionada.id,products:k.value,total:R.value};try{(await I.post("/api/vendas/salvar",i)).data.success&&n("updateMesa")}catch($){L.error(((g=(t=$.response)==null?void 0:t.data)==null?void 0:g.message)||"Erro ao salvar a venda.")}},me=async()=>{var t,g;const i={mesaId:A.MesaSelecionada.id,products:k.value,payments:j.value};try{(await I.post(`/api/vendas/finalizar/${A.mesaId}`,i)).data.success&&(L.success("Venda finalizada com sucesso!"),n("updateMesa"),W())}catch($){L.error(((g=(t=$.response)==null?void 0:t.data)==null?void 0:g.message)||"Erro ao finalizar a venda.")}},ve=async i=>{var t,g;try{y.value=!0;const $=await I.delete(`/api/vendas/${i}/excluir`);$.data.success?(L.success($.data.message),n("updateMesa"),W()):L.error($.data.message||"Erro ao excluir a venda.")}catch($){L.error(((g=(t=$.response)==null?void 0:t.data)==null?void 0:g.message)||"Erro inesperado ao excluir a venda.")}finally{y.value=!1}},G=V(()=>k.value.reduce((i,t)=>i+t.totalPrice,0)),te=V(()=>{const i=G.value-C.value;return i>=0?i:0}),R=V(()=>te.value+x.value),se=V(()=>N(G.value)),fe=V(()=>N(C.value));V(()=>N(te.value));const pe=V(()=>N(R.value));V(()=>k.value.map(i=>({...i,formattedPrice:N(i.totalPrice)})));const ge=V(()=>k.value.reduce((i,t)=>i+t.quantity,0));return(i,t)=>r.value?(l(),m("div",as,[e("div",os,[e("section",null,[e("div",ls,[e("div",ns,[e("div",rs,[t[17]||(t[17]=e("div",{class:"w-9 h-9 flex items-center justify-center text-sky-500"},[e("i",{class:"fa-solid fa-cart-shopping"})],-1)),e("h4",is,M(c.value||"Selecione uma mesa"),1),e("div",ds,[e("button",{onClick:t[0]||(t[0]=g=>b.value=!0),class:"rounded-full p-2 bg-red-500 hover:bg-red-600 text-white font-bold flex items-center space-x-2"}," Voltar ")])]),y.value?(l(),m("div",us,t[18]||(t[18]=[e("div",{class:"spinner"},null,-1)]))):S("",!0),B(ss,{formattedCartItems:k.value,onUpdateCart:P},null,8,["formattedCartItems"]),e("div",cs,[e("div",ms,[t[19]||(t[19]=e("p",{class:"font-semibold"},"Subtotal",-1)),e("p",vs,M(se.value),1)]),e("div",fs,[t[20]||(t[20]=e("p",{class:"font-semibold"},"Desconto",-1)),e("p",ps,M(fe.value),1)]),e("div",gs,[t[21]||(t[21]=e("p",{class:"text-xl font-bold"},"Total",-1)),e("p",bs,M(pe.value),1)]),t[22]||(t[22]=e("div",{class:"text-gray-600 flex justify-between"},[e("p",{class:"font-semibold"},"Restante")],-1))]),e("div",xs,[t[26]||(t[26]=e("button",{class:"bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-md flex items-center justify-center w-full"},[e("i",{class:"fa-solid fa-print"})],-1)),e("button",{onClick:t[1]||(t[1]=g=>u.value=!0),class:"bg-red-500 hover:bg-red-600 text-white p-3 rounded-md flex items-center justify-center w-full"},t[23]||(t[23]=[e("i",{class:"fa-solid fa-trash"},null,-1)])),e("button",{onClick:t[2]||(t[2]=g=>v.value=!0),class:"bg-yellow-500 hover:bg-yellow-600 text-white p-3 rounded-md flex items-center justify-center w-full"},t[24]||(t[24]=[e("i",{class:"fa-solid fa-dollar-sign mr-2"},null,-1)])),v.value?(l(),E(ut,{key:0,onClose:t[3]||(t[3]=g=>v.value=!1),"cart-total":G.value,onApplyDiscount:ie,"total-amount":se.value},null,8,["cart-total","total-amount"])):S("",!0),e("button",{onClick:t[4]||(t[4]=g=>a.value=!0),class:"bg-green-500 hover:bg-green-600 text-white p-3 rounded-md flex items-center justify-center w-full"},t[25]||(t[25]=[e("i",{class:"fa-solid fa-dollar-sign mr-2"},null,-1)])),a.value?(l(),E(pt,{key:1,onClose:t[5]||(t[5]=g=>a.value=!1),onApplyValue:de})):S("",!0)]),j.value.length===0?(l(),m("div",ys,[e("button",{class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mt-2 w-full",onClick:t[6]||(t[6]=g=>p.value=!0)}," Adicionar Forma de Pagamento ")])):(l(),m("div",ws,[e("button",{class:"bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded w-full",onClick:t[7]||(t[7]=g=>p.value=!0)}," Alterar Pagamentos "),e("button",{class:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded w-full",onClick:t[8]||(t[8]=g=>z.value=!0)}," Finalizar Pagamento ")])),T.value?(l(),E(Et,{key:3,onConfirm:ue,onClose:t[9]||(t[9]=g=>T.value=!1)})):S("",!0),z.value?(l(),E(Dt,{key:4,onConfirm:me,onClose:t[10]||(t[10]=g=>z.value=!1)})):S("",!0),p.value?(l(),E(Bt,{key:5,subtotal:G.value,"added-value":x.value,"discount-value":C.value,onSavePayments:w,onClose:t[11]||(t[11]=g=>p.value=!1)},null,8,["subtotal","added-value","discount-value"])):S("",!0)]),e("div",hs,[B(lt,{categories:f.categories,"cart-items":k.value,onAddToCart:re},null,8,["categories","cart-items"]),e("button",{class:"bg-blue-500 hover:bg-blue-700 text-white font-bold px-4 py-2 rounded mt-1 w-full",onClick:t[12]||(t[12]=g=>T.value=!0)}," Salvar ("+M(ge.value)+" itens) ",1)])])])]),B(K,{name:"fade"},{default:U(()=>[u.value?(l(),m("div",_s,[e("div",$s,[t[27]||(t[27]=e("h3",{class:"text-xl font-semibold mb-4 text-center"}," Tem certeza que deseja excluir esta venda? ",-1)),t[28]||(t[28]=e("p",{class:"mb-6 text-gray-600"},"Essa ação não pode ser desfeita.",-1)),e("div",Cs,[e("button",{onClick:t[13]||(t[13]=g=>ve(s.value)),class:"px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 w-full mr-2"}," Comfirmar "),e("button",{onClick:t[14]||(t[14]=g=>u.value=!1),class:"px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400 w-full"}," Cancelar ")])])])):S("",!0)]),_:1}),B(K,{name:"fade"},{default:U(()=>[b.value?(l(),m("div",Ms,[e("div",ks,[t[29]||(t[29]=e("h3",{class:"text-xl font-semibold mb-4 text-center"}," Tem certeza que deseja sair sem salvar esta venda? ",-1)),t[30]||(t[30]=e("p",{class:"mb-6 text-gray-600"},"Essa ação não pode ser desfeita.",-1)),e("div",Ps,[e("button",{onClick:t[15]||(t[15]=g=>W()),class:"px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 w-full mr-2"}," Comfirmar "),e("button",{onClick:t[16]||(t[16]=g=>b.value=!1),class:"px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400 w-full"}," Cancelar ")])])])):S("",!0)]),_:1})])):S("",!0)}},js=q(Ss,[["__scopeId","data-v-c7dde883"]]),As={},Vs={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",style:{fill:"rgba(0, 147, 228, 1)",transform:"0",msfilter:""}};function Is(f,o){return l(),m("div",null,[(l(),m("svg",Vs,o[0]||(o[0]=[e("path",{d:"M21.999 8a.997.997 0 0 0-.143-.515L19.147 2.97A2.01 2.01 0 0 0 17.433 2H6.565c-.698 0-1.355.372-1.714.971L2.142 7.485A.997.997 0 0 0 1.999 8c0 1.005.386 1.914 1 2.618V20a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1v-5h4v5a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-9.382c.614-.704 1-1.613 1-2.618zm-2.016.251A2.002 2.002 0 0 1 17.999 10c-1.103 0-2-.897-2-2 0-.068-.025-.128-.039-.192l.02-.004L15.219 4h2.214l2.55 4.251zm-9.977-.186L10.818 4h2.361l.813 4.065C13.957 9.138 13.079 10 11.999 10s-1.958-.862-1.993-1.935zM6.565 4h2.214l-.76 3.804.02.004c-.015.064-.04.124-.04.192 0 1.103-.897 2-2 2a2.002 2.002 0 0 1-1.984-1.749L6.565 4zm3.434 12h-4v-3h4v3z"},null,-1)])))])}const Bs=q(As,[["render",Is]]),qs={data(){return{isModalOpen:!1,numMesas:1}},methods:{openModal(){this.isModalOpen=!0},closeModal(){this.isModalOpen=!1},async generateMesas(){try{const f=await I.post("/api/mesas/alterar",{num_mesas:this.numMesas});this.$emit("updateMesa"),L.success(f.data.message),this.closeModal()}catch(f){L.error(f.response.data.message)}}}},Ls={key:0,class:"fixed inset-0 z-50 bg-gray-900 bg-opacity-50 flex justify-end items-start"},Es={class:"flex justify-between items-center border-b pb-4 mb-6"},Ts={class:"mb-6"},zs={class:"flex justify-end"};function Ds(f,o,d,n,r,v){return l(),m("div",null,[e("button",{onClick:o[0]||(o[0]=(...a)=>v.openModal&&v.openModal(...a)),class:"px-4 py-2 bg-blue-500 text-white rounded"},o[4]||(o[4]=[e("i",{class:"fa-solid fa-plus"},null,-1),ee(" Configurações ")])),B(K,{name:"slide"},{default:U(()=>[r.isModalOpen?(l(),m("div",Ls,[e("div",{class:O(["modal-content w-1/2 bg-white h-full p-6 overflow-y-auto transform transition-transform rounded-lg shadow-lg",{"slide-from-right":r.isModalOpen,"slide-to-right":!r.isModalOpen}])},[e("div",Es,[o[6]||(o[6]=e("h2",{class:"text-2xl font-semibold text-gray-800"}," Configurações de Mesas ",-1)),e("button",{onClick:o[1]||(o[1]=(...a)=>v.closeModal&&v.closeModal(...a)),class:"close-button absolute top-4 right-4 text-gray-500"},o[5]||(o[5]=[e("i",{class:"fas fa-times"},null,-1)]))]),e("div",Ts,[o[7]||(o[7]=e("label",{for:"mesaCount",class:"block text-gray-600 text-sm"}," Número de Mesas ",-1)),X(e("input",{"onUpdate:modelValue":o[2]||(o[2]=a=>r.numMesas=a),id:"mesaCount",type:"number",min:"1",max:"50",class:"w-full p-2 mt-2 border rounded-md",placeholder:"Digite o número de mesas"},null,512),[[Y,r.numMesas]])]),e("div",zs,[e("button",{onClick:o[3]||(o[3]=(...a)=>v.generateMesas&&v.generateMesas(...a)),class:"px-4 py-2 bg-blue-500 text-white rounded"}," Salvar ")])],2)])):S("",!0)]),_:1})])}const Os=q(qs,[["render",Ds],["__scopeId","data-v-c8bb672d"]]),Fs={class:"flex flex-1"},Ns={class:"content-wrapper flex-1 bg-gray-100 p-4"},Rs={class:"content"},Us={class:"container-fluid"},Hs={class:"row"},Ws={class:"col-12"},Gs={class:"text-2xl font-bold text-sky-500 flex items-center"},Qs={class:"mt-4"},Js={class:"flex justify-between items-center"},Xs={class:"flex space-x-4"},Ys={class:"flex gap-2"},Zs={class:"content mt-4"},Ks={class:"container-fluid"},ea={class:"row"},ta={key:0,class:"col-12"},sa={class:"bg-white shadow rounded-lg p-6"},aa={key:1,class:"col-12"},ua={__name:"Index",props:{mesas:{type:Array,required:!0},products:{type:Object,required:!0},categories:{type:Array,required:!0},filters:{type:Object,required:!0}},setup(f,{emit:o}){const d={MESAS:"mesas",BALCAO:"balcao"},n=h(d.MESAS),r=h(null),v=h(!1),a=h(!1);let p=h(0);function u(_){r.value=_}function b(){p.value++,console.log("Mesa atualizada")}const x=async()=>{try{a.value=!0;const _=await I.get("/api/caixa/status");v.value=_.data.status==="fechado"}catch(_){console.error("Erro ao verificar o status do caixa:",_)}finally{a.value=!1}},C=_=>{he.visit(route(_),{preserveScroll:!0,preserveState:!1})};return Z(v,_=>{_&&C("dashboard")}),J(()=>{x()}),(_,y)=>(l(),E(xe,{title:"Mesas"},{default:U(()=>[e("div",Fs,[e("div",Ns,[e("section",Rs,[e("div",Us,[e("div",Hs,[e("div",Ws,[e("h1",Gs,[B(Bs,{class:"h-6 w-6 mr-2"}),y[2]||(y[2]=ee(" Caixa "))]),e("section",Qs,[e("div",Js,[e("div",Xs,[e("button",{class:O(["px-4 py-3 rounded-t-lg focus:outline-none",{"bg-white text-blue-600 font-semibold":n.value===d.MESAS,"bg-gray-100 text-gray-600":n.value!==d.MESAS}]),onClick:y[0]||(y[0]=k=>n.value=d.MESAS)}," Mesas ",2),e("button",{class:O(["px-4 py-3 rounded-t-lg focus:outline-none",{"bg-white text-blue-600 font-semibold":n.value===d.BALCAO,"bg-gray-100 text-gray-600":n.value!==d.BALCAO}]),onClick:y[1]||(y[1]=k=>n.value=d.BALCAO)}," Balcão ",2)]),e("div",Ys,[B(Os,{onUpdateMesa:b})])]),e("section",Zs,[e("div",Ks,[e("div",ea,[n.value===d.MESAS?(l(),m("div",ta,[e("div",sa,[(l(),E(Re,{mesas:f.mesas,onMesaClick:u,key:we(p)},null,8,["mesas"])),B(js,{products:f.products,categories:f.categories,filters:f.filters,"Mesa-selecionada":r.value,onUpdateMesa:b},null,8,["products","categories","filters","Mesa-selecionada"])])])):S("",!0),n.value===d.BALCAO?(l(),m("div",aa,y[3]||(y[3]=[e("div",{class:"bg-white shadow rounded-lg p-6"},[e("p",{class:"text-gray-500"}," Nenhuma funcionalidade implementada ainda. ")],-1)]))):S("",!0)])])])])])])])])])])]),_:1}))}};export{ua as default};
