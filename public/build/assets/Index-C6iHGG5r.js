import{o as i,e as m,a as e,F as A,g as G,n as H,c as J,w as L,t as F,h as q,l as K,d as v,v as $,z as ce,H as W,I as pe,u as T,f as E,m as B,B as O,C as Y,b as I,E as ue,k as V,p as Q,J as ge,s as fe,A as ve,K as be}from"./app-CGrFRThM.js";import{_ as ye}from"./AppLayout-BZcXL0MU.js";import{d as xe}from"./IconCofingBranco-b62jRgVI.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{I as te}from"./InputNumber-Bvu0TAUN.js";import{u as ee}from"./store-CiEZvh8G.js";const ke={class:"flex flex-wrap justify-center gap-2 mt-4"},we={class:"flex flex-wrap gap-2"},he=["onClick","disabled"],_e=["innerHTML"],Ce={__name:"Paginetion",props:{links:{type:Array,required:!0}},setup(a,{emit:t}){const u=t,x=l=>{u("navegar",l)};return(l,c)=>(i(),m("div",ke,[e("div",we,[(i(!0),m(A,null,G(a.links.filter(g=>g.label&&g.url),(g,r)=>(i(),m("button",{key:r,onClick:k=>x(g.url),class:H({"px-4 py-2 text-gray-700 rounded-lg text-sm sm:text-base":!0,"bg-blue-500 text-white":g.active,"bg-gray-200":!g.active,"cursor-not-allowed opacity-50":!g.url}),disabled:!g.url},[e("span",{innerHTML:g.label},null,8,_e)],10,he))),128))])]))}},Ie={key:0,class:"fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50"},$e={class:"bg-white rounded-lg shadow-lg max-w-md w-full p-6"},Ee={class:"text-lg font-semibold text-gray-800 mb-4"},Se={class:"text-gray-600 mb-6"},je={class:"flex justify-end gap-2"},qe={__name:"ConfirmModal",props:{isOpen:{type:Boolean,required:!0},isWarning:{type:Boolean,default:!1},message:{type:String,required:!0}},emits:["cancelar","confirmar"],setup(a){return(t,u)=>(i(),J(K,{name:"fade"},{default:L(()=>[a.isOpen?(i(),m("div",Ie,[e("div",$e,[e("h3",Ee,F(a.isWarning?"Aviso":"Confirmação"),1),e("p",Se,F(a.message),1),e("div",je,[e("button",{class:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",onClick:u[0]||(u[0]=x=>t.$emit("cancelar"))}," Fechar "),a.isWarning?q("",!0):(i(),m("button",{key:0,class:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600",onClick:u[1]||(u[1]=x=>t.$emit("confirmar"))}," Confirmar "))])])])):q("",!0)]),_:1}))}},Pe={class:"relative inline-block"},Fe={class:"dropdown-menu absolute bg-white text-gray-700 shadow-md mt-1 rounded-lg z-50"},Ve={__name:"DropdownMenu",setup(a){const t=v(!1),u=l=>{l.stopPropagation(),t.value=!t.value},x=l=>{!l.target.closest(".dropdown-menu")&&!l.target.closest("button")&&(t.value=!1)};return document.addEventListener("click",x),(l,c)=>(i(),m("div",Pe,[e("button",{onClick:u,class:"text-gray-500 hover:text-gray-600 text-3xl"},c[0]||(c[0]=[e("i",{class:"fas fa-ellipsis-v"},null,-1)])),$(e("ul",Fe,c[1]||(c[1]=[e("li",null,[e("button",{class:"block px-4 py-2 text-sm"},"Editar")],-1),e("li",null,[e("button",{class:"block px-4 py-2 text-sm"},"Adicionar/Remover Favorito")],-1),e("li",null,[e("button",{class:"block px-4 py-2 text-sm"},"Excluir")],-1)]),512),[[ce,t.value]])]))}},Me=z(Ve,[["__scopeId","data-v-ca24ebce"]]);var Ne="Expected a function",oe=NaN,Oe="[object Symbol]",Ae=/^\s+|\s+$/g,Re=/^[-+]0x[0-9a-f]+$/i,Te=/^0b[01]+$/i,Ue=/^0o[0-7]+$/i,De=parseInt,Le=typeof W=="object"&&W&&W.Object===Object&&W,Ge=typeof self=="object"&&self&&self.Object===Object&&self,Be=Le||Ge||Function("return this")(),ze=Object.prototype,Je=ze.toString,Qe=Math.max,We=Math.min,X=function(){return Be.Date.now()};function He(a,t,u){var x,l,c,g,r,k,h=0,b=!1,w=!1,_=!0;if(typeof a!="function")throw new TypeError(Ne);t=se(t)||0,Z(u)&&(b=!!u.leading,w="maxWait"in u,c=w?Qe(se(u.maxWait)||0,t):c,_="trailing"in u?!!u.trailing:_);function S(p){var d=x,o=l;return x=l=void 0,h=p,g=a.apply(o,d),g}function C(p){return h=p,r=setTimeout(P,t),b?S(p):g}function M(p){var d=p-k,o=p-h,s=t-d;return w?We(s,c-o):s}function R(p){var d=p-k,o=p-h;return k===void 0||d>=t||d<0||w&&o>=c}function P(){var p=X();if(R(p))return N(p);r=setTimeout(P,M(p))}function N(p){return r=void 0,_&&x?S(p):(x=l=void 0,g)}function U(){r!==void 0&&clearTimeout(r),h=0,x=k=l=r=void 0}function y(){return r===void 0?g:N(X())}function n(){var p=X(),d=R(p);if(x=arguments,l=this,k=p,d){if(r===void 0)return C(k);if(w)return r=setTimeout(P,t),S(k)}return r===void 0&&(r=setTimeout(P,t)),g}return n.cancel=U,n.flush=y,n}function Z(a){var t=typeof a;return!!a&&(t=="object"||t=="function")}function Ke(a){return!!a&&typeof a=="object"}function Xe(a){return typeof a=="symbol"||Ke(a)&&Je.call(a)==Oe}function se(a){if(typeof a=="number")return a;if(Xe(a))return oe;if(Z(a)){var t=typeof a.valueOf=="function"?a.valueOf():a;a=Z(t)?t+"":t}if(typeof a!="string")return a===0?a:+a;a=a.replace(Ae,"");var u=Te.test(a);return u||Ue.test(a)?De(a.slice(2),u?2:8):Re.test(a)?oe:+a}var Ze=He;const me=pe(Ze),Ye={key:0,class:"fixed inset-0 z-50 bg-gray-900 bg-opacity-50 flex justify-end"},et={class:"modal-content w-50 sm:w-4/5 md:w-2/3 lg:w-1/2 xl:w-1/2 bg-white p-6 h-full overflow-auto transform transition-all duration-300 ease-in-out"},tt={class:"space-y-4"},ot={key:0},st={class:"flex justify-content-evenly gap-4 mt-6"},at=["value"],rt={key:1},lt={class:"flex justify-end gap-4 mt-6"},nt={class:"flex gap-4 mt-6"},it={class:"flex gap-4 mt-6"},dt=["disabled"],ut=["disabled"],mt={class:"space-y-4"},ct=["src"],pt={key:0,class:"mt-4"},gt=["onClick"],ft=["src","alt"],vt={key:1,class:"mt-4 text-gray-500"},bt={key:0,class:"absolute inset-0 flex justify-center items-center bg-gray-50 bg-opacity-50"},ae="AIzaSyBQcLZJqbHPUq9XM6bjOpopQ5fJaMkmq1U",re="a7c7f9a8761d54e79",le=100,yt={__name:"CadastroProduto",props:{categories:{type:Array,required:!0}},setup(a){const t=ee(),u=v(!1),x=v(!1),l=v(null),c=v(null),g=v([]),r=v({name:"",image:null,category_id:"",price:null,cost_price:null,barcode:"",stock_quantity:0,min_stock:5}),k=a,h=()=>{b(),t.activateComponent("categoria")},b=()=>{x.value=!1,r.value={name:"",category_id:"",price:null,cost_price:null,barcode:"",stock_quantity:0,min_stock:5,image:null},c.value=null,t.deactivateComponent()},w=v(""),_=v([]),S=v(!1),C=v(0),M=v(!0),R=v(!0),P=me(async()=>{const d=r.value.name.trim();if(d.length<4||d===w.value){g.value=_.value;return}try{let o=[];if(M.value){const s=await axios.get("/products/images",{params:{term:d}});s.data.length>0&&(o=s.data,g.value=o,w.value=d,_.value=o)}if(R.value&&o.length===0&&C.value<le){const s=await axios.get("https://www.googleapis.com/customsearch/v1",{params:{key:ae,cx:re,searchType:"image",q:d,num:10}});C.value++;const f=["image/jpeg","image/jpg","image/png","image/webp"],j=(s.data.items||[]).filter(D=>f.includes(D.mime));j.length>0&&(o=j),g.value=o,w.value=d,_.value=o}else C.value>=le&&(S.value=!0);o.length===0&&console.log("Nenhuma imagem encontrada para:",d)}catch(o){if(console.error("Erro na busca de imagens:",o),M.value&&R.value)try{const s=await axios.get("https://www.googleapis.com/customsearch/v1",{params:{key:ae,cx:re,searchType:"image",q:d,num:10}});C.value++;const f=["image/jpeg","image/jpg","image/png","image/webp"],j=(s.data.items||[]).filter(D=>f.includes(D.mime));j.length>0&&(g.value=j,w.value=d,_.value=j)}catch(s){console.error("Erro na busca de imagens na API do Google:",s)}}},2e3);function N(){C.value=0,S.value=!1}setTimeout(N,24*60*60*1e3);const U=async d=>{try{const s=await(await fetch(d)).blob(),f=d.split("/").pop(),j=new File([s],f,{type:s.type}),D=new FileReader;D.onloadend=()=>{c.value=D.result},D.readAsDataURL(j),r.value.image=j}catch(o){console.error("Erro ao baixar a imagem:",o),V.error("Erro ao baixar a imagem. Tente novamente.")}},y=()=>{l.value&&l.value.click()},n=d=>{const o=d.target.files[0];if(!o)return;if(!["image/jpeg","image/png","image/webp"].includes(o.type)){alert("Formato inválido! Apenas arquivos JPEG, WEBP e PNG são permitidos.");return}r.value.image=o;const f=new FileReader;f.onload=()=>{c.value=f.result},f.readAsDataURL(o)},p=async()=>{u.value=!0;const d=new FormData;d.append("name",r.value.name),d.append("category_id",r.value.category_id),d.append("price",(r.value.price/100).toFixed(2)),d.append("cost_price",(r.value.cost_price/100).toFixed(2)),d.append("barcode",r.value.barcode),d.append("stock_quantity",r.value.stock_quantity),d.append("min_stock",r.value.min_stock),r.value.image&&d.append("image",r.value.image),Q.visit(route("produto.adicionar"),{method:"post",data:d,preserveState:!0,preserveScroll:!0,onSuccess:()=>{b(),u.value=!1,V.success("Produto cadastrado com sucesso!")},onError:o=>{console.error(o),u.value=!1,V.error("Erro ao cadastrar o produto."+o)}})};return(d,o)=>(i(),m("div",null,[T(t).activeComponent==="produto"?(i(),m("div",Ye,[e("div",et,[e("button",{onClick:b,class:"close-button absolute top-4 right-4 text-gray-500"},o[8]||(o[8]=[e("i",{class:"fas fa-times"},null,-1)])),o[26]||(o[26]=e("h2",{class:"text-2xl mb-4"},[e("i",{class:"fa-solid fa-box-open"}),E(" Cadastro de Produto ")],-1)),e("form",{onSubmit:B(p,["prevent"]),class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},[e("div",tt,[e("div",null,[o[9]||(o[9]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700"}," Nome do Produto ",-1)),$(e("input",{type:"text",id:"name","onUpdate:modelValue":o[0]||(o[0]=s=>r.value.name=s),onInput:o[1]||(o[1]=(...s)=>T(P)&&T(P)(...s)),required:"",class:"mt-1 px-3 py-2 w-full border border-gray-300 rounded"},null,544),[[O,r.value.name]])]),k.categories&&k.categories.length>0?(i(),m("div",ot,[e("div",st,[o[11]||(o[11]=e("label",{for:"category",class:"text-sm font-medium text-gray-700"}," Categoria ",-1)),e("button",{onClick:B(h,["stop"]),style:{color:"#0079d6",cursor:"pointer"}},o[10]||(o[10]=[e("i",{class:"fa-solid fa-circle-plus"},null,-1)]))]),$(e("select",{id:"category","onUpdate:modelValue":o[2]||(o[2]=s=>r.value.category_id=s),required:"",class:"mt-1 px-3 py-2 w-full border border-gray-300 rounded"},[o[12]||(o[12]=e("option",{value:""},"Selecione a Categoria",-1)),(i(!0),m(A,null,G(k.categories,s=>(i(),m("option",{key:s.id,value:s.id},F(s.name),9,at))),128))],512),[[Y,r.value.category_id]])])):(i(),m("div",rt,o[13]||(o[13]=[e("p",null,"Carregando categorias...",-1)]))),e("div",lt,[e("div",null,[o[14]||(o[14]=e("label",{for:"price",class:"block text-sm font-medium text-gray-700"}," Valor de Venda (R$) ",-1)),I(te,{modelValue:r.value.price,"onUpdate:modelValue":o[3]||(o[3]=s=>r.value.price=s),modelModifiers:{number:!0},id:"price"},null,8,["modelValue"])]),e("div",null,[o[15]||(o[15]=e("label",{for:"cost_price",class:"block text-sm font-medium text-gray-700"}," Valor de Custo (R$) ",-1)),I(te,{modelValue:r.value.cost_price,"onUpdate:modelValue":o[4]||(o[4]=s=>r.value.cost_price=s),modelModifiers:{number:!0},id:"cost_price"},null,8,["modelValue"])])]),e("div",nt,[e("div",null,[o[16]||(o[16]=e("label",{for:"stock_quantity",class:"block text-sm font-medium text-gray-700"}," Estoque ",-1)),$(e("input",{type:"number",id:"stock_quantity","onUpdate:modelValue":o[5]||(o[5]=s=>r.value.stock_quantity=s),required:"",class:"mt-1 px-3 py-2 w-full border border-gray-300 rounded"},null,512),[[O,r.value.stock_quantity,void 0,{number:!0}]])]),e("div",null,[o[17]||(o[17]=e("label",{for:"min_stock",class:"block text-sm font-medium text-gray-700"}," Estoque Minimo ",-1)),$(e("input",{type:"number",id:"min_stock","onUpdate:modelValue":o[6]||(o[6]=s=>r.value.min_stock=s),required:"",class:"mt-1 px-3 py-2 w-full border border-gray-300 rounded",title:"Estoque minimo para que seja avisado!"},null,512),[[O,r.value.min_stock,void 0,{number:!0}]])])]),e("div",it,[e("button",{type:"button",onClick:b,class:"w-1/2 px-4 py-2 border border-gray-300 text-gray-700 rounded hover:bg-gray-100",disabled:u.value}," Cancelar ",8,dt),e("button",{type:"submit",class:"w-1/2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50",disabled:u.value}," Cadastrar ",8,ut)])]),e("div",mt,[e("div",null,[o[21]||(o[21]=e("label",{for:"image",class:"block text-sm font-medium text-gray-700 mb-2"}," Foto do Produto ",-1)),e("div",{class:"flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-gray-300 rounded-lg bg-gray-50 hover:border-gray-400 transition cursor-pointer",onClick:y},[c.value?(i(),m("img",{key:0,src:c.value,alt:"Preview da Imagem",class:"object-contain w-[90%] h-[90%] rounded-md transition-transform duration-300 ease-in-out hover:scale-105"},null,8,ct)):(i(),m(A,{key:1},[o[18]||(o[18]=e("i",{class:"fas fa-box-open text-gray-400 text-4xl mb-4"},null,-1)),o[19]||(o[19]=e("p",{class:"text-gray-600 text-sm font-medium"},"Enviar imagem",-1)),o[20]||(o[20]=e("p",{class:"text-gray-400 text-xs"},[E(" Formatos permitidos: JPEG, JPG, PNG "),e("br"),E(" Resolução ideal: 400x400 ou 800x800 ")],-1))],64))]),e("input",{type:"file",id:"image",ref_key:"imageInput",ref:l,onChange:n,class:"hidden"},null,544)]),g.value.length>0?(i(),m("div",pt,[o[22]||(o[22]=e("p",{class:"font-semibold text-purple-600"},"Sugestões de foto",-1)),I(ue,{name:"fade",tag:"div",class:"grid grid-cols-3 gap-4",duration:2e3},{default:L(()=>[(i(!0),m(A,null,G(g.value,(s,f)=>(i(),m("div",{key:f,class:"cursor-pointer p-2",onClick:j=>U(s.link)},[e("img",{src:s.link,alt:s.title,class:"w-full h-24 object-cover rounded-md"},null,8,ft)],8,gt))),128))]),_:1})])):(i(),m("div",vt,o[23]||(o[23]=[e("p",{class:"font-semibold text-purple-600"},"Sugestões de foto",-1),e("p",{class:"mt-3"},"Nada no momento...",-1)]))),e("div",null,[o[24]||(o[24]=e("label",{for:"barcode",class:"block text-sm font-medium text-gray-700"}," Código de Barras (EAN) ",-1)),$(e("input",{type:"text",id:"barcode","onUpdate:modelValue":o[7]||(o[7]=s=>r.value.barcode=s),class:"mt-1 px-3 py-2 w-full border border-gray-300 rounded"},null,512),[[O,r.value.barcode]])])]),u.value?(i(),m("div",bt,o[25]||(o[25]=[e("div",{class:"loader border-4 border-t-blue-500 border-gray-200 rounded-full w-12 h-12 animate-spin"},null,-1)]))):q("",!0)],32)])])):q("",!0)]))}},xt=z(yt,[["__scopeId","data-v-e7d10a6d"]]),kt={props:{modelValue:{type:[Number,String],default:0}},computed:{formattedValue(){return this.formatCurrency(Number(this.modelValue))}},methods:{onInput(a){const t=a.target.value.replace(/\D/g,""),u=parseInt(t||"0",10);this.$emit("update:modelValue",u)},formatCurrency(a){return`R$ ${(a/100).toFixed(2).replace(".",",")}`},allowOnlyNumbers(a){const t=["Backspace","Tab","ArrowLeft","ArrowRight"];!(a.key>="0"&&a.key<="9")&&!t.includes(a.key)&&a.preventDefault()}}},wt=["value"];function ht(a,t,u,x,l,c){return i(),m("div",null,[e("input",{type:"text",value:c.formattedValue,onInput:t[0]||(t[0]=(...g)=>c.onInput&&c.onInput(...g)),onKeydown:t[1]||(t[1]=(...g)=>c.allowOnlyNumbers&&c.allowOnlyNumbers(...g)),placeholder:"R$ 0,00",class:"mt-1 px-3 py-2 w-full border border-gray-300 rounded"},null,40,wt)])}const _t=z(kt,[["render",ht]]),Ct={components:{InputNumberEdit:_t},props:{produto:Object,categories:{type:Array,default:()=>[]}},data(){return{form:{...this.produto,price:parseFloat(this.produto.price).toFixed(2)*100||0,cost_price:parseFloat(this.produto.cost_price).toFixed(2)*100||0},imagePreview:null,imageInput:this.produto.image_path||null,isSubmitting:!1,isModalOpenEdit:!0}},methods:{closeModal(){this.isModalOpenEdit=!1,setTimeout(()=>{this.$emit("close")},300)},submitForm(){this.isSubmitting=!0;const a=new FormData;a.append("name",this.form.name),a.append("category_id",this.form.category_id),a.append("price",(this.form.price/100).toFixed(2)),a.append("cost_price",(this.form.cost_price/100).toFixed(2)),a.append("barcode",this.form.barcode),a.append("stock_quantity",this.form.stock_quantity),a.append("min_stock",this.form.min_stock),this.imagePreview?a.append("image",this.$refs.imageInput.files[0]):this.form.image_path&&a.append("current_image_path",this.form.image_path),Q.visit(route("produto.update",this.form.id),{method:"post",data:a,preserveState:!0,preserveScroll:!0,onStart:()=>{this.isSubmitting=!0},onFinish:()=>{this.isSubmitting=!1},onSuccess:t=>{V.success("Item atualizado"),this.closeModal()},onError:t=>{console.error(t),V.error("Erro ao atualizar o item.")}})},handleImageChange(a){const t=a.target.files[0];if(t){if(!["image/jpeg","image/png"].includes(t.type)){V.error("Formato inválido! Apenas arquivos JPEG e PNG são permitidos.");return}this.imagePreview=URL.createObjectURL(t)}},triggerImageUpload(){this.$refs.imageInput.click()}},watch:{produto(a){this.form={...a}}}},It={key:0,class:"fixed inset-0 z-50 bg-gray-900 bg-opacity-50 flex justify-end"},$t={class:"space-y-4"},Et={key:0},St={class:"flex justify-content-evenly gap-4 mt-6"},jt=["value"],qt={key:1},Pt={class:"flex justify-end gap-4 mt-6"},Ft={class:"flex gap-4 mt-6"},Vt={class:"flex gap-4 mt-6"},Mt=["disabled"],Nt=["disabled"],Ot={class:"space-y-4"},At=["src"],Rt={key:0,class:"absolute inset-0 flex justify-center items-center bg-gray-50 bg-opacity-50"};function Tt(a,t,u,x,l,c){const g=ge("InputNumberEdit");return i(),m("div",null,[I(K,{name:"slide"},{default:L(()=>[l.isModalOpenEdit?(i(),m("div",It,[e("div",{class:H(["modal-content w-50 sm:w-4/5 md:w-2/3 lg:w-1/2 xl:w-1/2 bg-white p-6 h-full overflow-auto transform transition-all duration-300 ease-in-out",{"slide-from-right":l.isModalOpenEdit,"slide-to-right":!l.isModalOpenEdit}])},[e("button",{onClick:t[0]||(t[0]=(...r)=>c.closeModal&&c.closeModal(...r)),class:"close-button absolute top-4 right-4 text-gray-500"},t[13]||(t[13]=[e("i",{class:"fas fa-times"},null,-1)])),t[30]||(t[30]=e("h2",{class:"text-2xl mb-4"},[e("i",{class:"fa-solid fa-box-open"}),E(" Editar Produto ")],-1)),e("form",{onSubmit:t[12]||(t[12]=B((...r)=>c.submitForm&&c.submitForm(...r),["prevent"])),class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},[e("div",$t,[e("div",null,[t[14]||(t[14]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700"}," Nome do Produto ",-1)),$(e("input",{type:"text",id:"name","onUpdate:modelValue":t[1]||(t[1]=r=>l.form.name=r),required:"",class:"mt-1 px-3 py-2 w-full border border-gray-300 rounded"},null,512),[[O,l.form.name]])]),u.categories&&u.categories.length>0?(i(),m("div",Et,[e("div",St,[t[16]||(t[16]=e("label",{for:"category",class:"text-sm font-medium text-gray-700"}," Categoria ",-1)),e("button",{onClick:t[2]||(t[2]=B((...r)=>a.ativarCategoria&&a.ativarCategoria(...r),["stop"])),style:{color:"#0079d6",cursor:"pointer"}},t[15]||(t[15]=[e("i",{class:"fa-solid fa-circle-plus"},null,-1)]))]),$(e("select",{id:"category","onUpdate:modelValue":t[3]||(t[3]=r=>l.form.category_id=r),required:"",class:"mt-1 px-3 py-2 w-full border border-gray-300 rounded"},[t[17]||(t[17]=e("option",{value:""},"Selecione a Categoria",-1)),(i(!0),m(A,null,G(u.categories,r=>(i(),m("option",{key:r.id,value:r.id},F(r.name),9,jt))),128))],512),[[Y,l.form.category_id]])])):(i(),m("div",qt,t[18]||(t[18]=[e("p",null,"Carregando categorias...",-1)]))),e("div",Pt,[e("div",null,[t[19]||(t[19]=e("label",{for:"price",class:"block text-sm font-medium text-gray-700"}," Valor de Venda (R$) ",-1)),I(g,{modelValue:l.form.price,"onUpdate:modelValue":t[4]||(t[4]=r=>l.form.price=r),modelModifiers:{number:!0},id:"price",required:""},null,8,["modelValue"])]),e("div",null,[t[20]||(t[20]=e("label",{for:"cost_price",class:"block text-sm font-medium text-gray-700"}," Valor de Custo (R$) ",-1)),I(g,{modelValue:l.form.cost_price,"onUpdate:modelValue":t[5]||(t[5]=r=>l.form.cost_price=r),modelModifiers:{number:!0},id:"cost_price"},null,8,["modelValue"])])]),e("div",Ft,[e("div",null,[t[21]||(t[21]=e("label",{for:"stock_quantity",class:"block text-sm font-medium text-gray-700"}," Estoque ",-1)),$(e("input",{type:"number",id:"stock_quantity","onUpdate:modelValue":t[6]||(t[6]=r=>l.form.stock_quantity=r),class:"mt-1 px-3 py-2 w-full border border-gray-300 rounded"},null,512),[[O,l.form.stock_quantity,void 0,{number:!0}]])]),e("div",null,[t[22]||(t[22]=e("label",{for:"min_stock",class:"block text-sm font-medium text-gray-700"}," Estoque Minimo ",-1)),$(e("input",{type:"number",id:"min_stock","onUpdate:modelValue":t[7]||(t[7]=r=>l.form.min_stock=r),class:"mt-1 px-3 py-2 w-full border border-gray-300 rounded",title:"Estoque minimo para que seja avisado!"},null,512),[[O,l.form.min_stock,void 0,{number:!0}]])])]),e("div",Vt,[e("button",{type:"button",onClick:t[8]||(t[8]=(...r)=>c.closeModal&&c.closeModal(...r)),class:"w-1/2 px-4 py-2 border border-gray-300 text-gray-700 rounded hover:bg-gray-100",disabled:l.isSubmitting}," Cancelar ",8,Mt),e("button",{type:"submit",class:"w-1/2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50",disabled:l.isSubmitting}," Atualizar ",8,Nt)])]),e("div",Ot,[e("div",null,[t[26]||(t[26]=e("label",{for:"image",class:"block text-sm font-medium text-gray-700 mb-2"}," Foto do Produto ",-1)),e("div",{class:"flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-gray-300 rounded-lg bg-gray-50 hover:border-gray-400 transition cursor-pointer",onClick:t[9]||(t[9]=(...r)=>c.triggerImageUpload&&c.triggerImageUpload(...r))},[l.imagePreview||l.form.image_path?(i(),m("img",{key:0,src:l.imagePreview||"/storage/"+(l.form.image_path||"default-product-image.jpg"),alt:"Preview da Imagem",class:"object-contain w-[90%] h-[90%] rounded-md transition-transform duration-300 ease-in-out hover:scale-105"},null,8,At)):(i(),m(A,{key:1},[t[23]||(t[23]=e("i",{class:"fas fa-box-open text-gray-400 text-4xl mb-4"},null,-1)),t[24]||(t[24]=e("p",{class:"text-gray-600 text-sm font-medium"}," Enviar imagem ",-1)),t[25]||(t[25]=e("p",{class:"text-gray-400 text-xs"},[E(" Formatos permitidos: JPEG, JPG, PNG "),e("br"),E(" Resolução ideal: 400x400 ou 800x800 ")],-1))],64))]),e("input",{type:"file",id:"image",ref:"imageInput",onChange:t[10]||(t[10]=(...r)=>c.handleImageChange&&c.handleImageChange(...r)),class:"hidden"},null,544)]),t[28]||(t[28]=e("div",{class:"mt-4 text-sm text-gray-600"},[e("p",{class:"font-semibold text-purple-600"},"Sugestões de foto"),e("span",null,"Nada no momento...")],-1)),e("div",null,[t[27]||(t[27]=e("label",{for:"barcode",class:"block text-sm font-medium text-gray-700"}," Código de Barras (EAN) ",-1)),$(e("input",{type:"text",id:"barcode","onUpdate:modelValue":t[11]||(t[11]=r=>l.form.barcode=r),class:"mt-1 px-3 py-2 w-full border border-gray-300 rounded"},null,512),[[O,l.form.barcode]])])]),l.isSubmitting?(i(),m("div",Rt,t[29]||(t[29]=[e("div",{class:"loader border-4 border-t-blue-500 border-gray-200 rounded-full w-12 h-12 animate-spin"},null,-1)]))):q("",!0)],32)],2)])):q("",!0)]),_:1})])}const Ut=z(Ct,[["render",Tt],["__scopeId","data-v-92486df0"]]),Dt={key:0,class:"fixed inset-0 z-50 bg-gray-900 bg-opacity-50 flex justify-end"},Lt={class:"modal-content w-50 sm:w-4/5 md:w-2/3 lg:w-1/2 xl:w-1/2 bg-white p-6 h-full overflow-auto transform transition-all duration-300 ease-in-out"},Gt={class:"space-y-4"},Bt={class:"flex gap-4 mt-6"},zt=["disabled"],Jt=["disabled"],Qt={class:"space-y-4"},Wt=["src"],Ht={key:0,class:"mt-4"},Kt=["onClick"],Xt=["src","alt"],Zt={key:1,class:"mt-4 text-gray-500"},Yt={key:0,class:"absolute inset-0 flex justify-center items-center bg-gray-50 bg-opacity-50"},ne="AIzaSyBQcLZJqbHPUq9XM6bjOpopQ5fJaMkmq1U",ie="a7c7f9a8761d54e79",de=100,eo={__name:"CadastroCategoria",setup(a){const t=ee(),u=v(!1),x=v(null),l=v(null),c=v([]),g=v({name:"",image:null}),r=v(""),k=v([]),h=v(!1),b=v(0),w=v(!0),_=v(!0),S=me(async()=>{const y=g.value.name.trim();if(y.length<4||y===r.value){c.value=k.value;return}try{let n=[];if(w.value){const p=await axios.get("/products/images",{params:{term:y}});p.data.length>0&&(n=p.data,c.value=n,r.value=y,k.value=n)}if(_.value&&n.length===0&&b.value<de){const p=await axios.get("https://www.googleapis.com/customsearch/v1",{params:{key:ne,cx:ie,searchType:"image",q:y,num:10}});b.value++;const d=["image/jpeg","image/jpg","image/png","image/webp"],o=(p.data.items||[]).filter(s=>d.includes(s.mime));o.length>0&&(n=o),c.value=n,r.value=y,k.value=n}else b.value>=de&&(h.value=!0);n.length===0&&console.log("Nenhuma imagem encontrada para:",y)}catch(n){if(console.error("Erro na busca de imagens:",n),w.value&&_.value)try{const p=await axios.get("https://www.googleapis.com/customsearch/v1",{params:{key:ne,cx:ie,searchType:"image",q:y,num:10}});b.value++;const d=["image/jpeg","image/jpg","image/png","image/webp"],o=(p.data.items||[]).filter(s=>d.includes(s.mime));o.length>0&&(c.value=o,r.value=y,k.value=o)}catch(p){console.error("Erro na busca de imagens na API do Google:",p)}}},2e3);function C(){b.value=0,h.value=!1}setTimeout(C,24*60*60*1e3);const M=async y=>{try{const p=await(await fetch(y)).blob(),d=y.split("/").pop(),o=new File([p],d,{type:p.type}),s=new FileReader;s.onloadend=()=>{l.value=s.result},s.readAsDataURL(o),g.value.image=o}catch(n){console.error("Erro ao baixar a imagem:",n),V.error("Erro ao baixar a imagem. Tente novamente.")}},R=()=>{x.value&&x.value.click()},P=y=>{const n=y.target.files[0];if(!n)return;if(!["image/jpeg","image/png","image/webp"].includes(n.type)){alert("Formato inválido! Apenas arquivos JPEG e PNG são permitidos.");return}g.value.image=n;const d=new FileReader;d.onload=()=>{l.value=d.result},d.readAsDataURL(n)},N=()=>{g.value={name:"",image:null},l.value=null,t.deactivateComponent()},U=async()=>{u.value=!0;const y=new FormData;y.append("name",g.value.name),g.value.image&&y.append("image",g.value.image),Q.visit(route("categoria.adicionar"),{method:"post",data:y,preserveState:!0,preserveScroll:!0,onSuccess:()=>{N(),u.value=!1,V.success("Categoria cadastrado com sucesso!")},onError:n=>{console.error(n),u.value=!1,V.error("Erro ao cadastrar a Categoria."+n)}})};return(y,n)=>(i(),m("div",null,[T(t).activeComponent==="categoria"?(i(),m("div",Dt,[e("div",Lt,[e("button",{onClick:N,class:"absolute top-4 right-4 text-gray-500"},n[2]||(n[2]=[e("i",{class:"fas fa-times"},null,-1)])),n[11]||(n[11]=e("h2",{class:"text-2xl mb-4"},[e("i",{class:"fa-solid fa-box-open"}),E(" Cadastrar Categoria ")],-1)),e("form",{onSubmit:B(U,["prevent"]),class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},[e("div",Gt,[e("div",null,[n[3]||(n[3]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700"}," Nome da Categoria ",-1)),$(e("input",{type:"text",id:"name","onUpdate:modelValue":n[0]||(n[0]=p=>g.value.name=p),onInput:n[1]||(n[1]=(...p)=>T(S)&&T(S)(...p)),required:"",class:"mt-1 px-3 py-2 w-full border border-gray-300 rounded"},null,544),[[O,g.value.name]])]),e("div",Bt,[e("button",{type:"button",onClick:N,class:"w-1/2 px-4 py-2 border border-gray-300 text-gray-700 rounded hover:bg-gray-100",disabled:u.value}," Cancelar ",8,zt),e("button",{type:"submit",class:"w-1/2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50",disabled:u.value}," Cadastrar ",8,Jt)])]),e("div",Qt,[e("div",null,[n[7]||(n[7]=e("label",{for:"image",class:"block text-sm font-medium text-gray-700 mb-2"}," Foto da Categoria ",-1)),e("div",{class:"flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-gray-300 rounded-lg bg-gray-50 hover:border-gray-400 transition cursor-pointer",onClick:R},[l.value?(i(),m("img",{key:0,src:l.value,alt:"Preview da Imagem",class:"object-contain w-[90%] h-[90%] rounded-md transition-transform duration-300 ease-in-out hover:scale-105"},null,8,Wt)):(i(),m(A,{key:1},[n[4]||(n[4]=e("i",{class:"fas fa-box-open text-gray-400 text-4xl mb-4"},null,-1)),n[5]||(n[5]=e("p",{class:"text-gray-600 text-sm font-medium"},"Enviar imagem",-1)),n[6]||(n[6]=e("p",{class:"text-gray-400 text-xs"},[E(" Formatos permitidos: JPEG, JPG, PNG "),e("br"),E(" Resolução ideal: 400x400 ou 800x800 ")],-1))],64))]),e("input",{type:"file",id:"image",ref_key:"imageInput",ref:x,onChange:P,class:"hidden"},null,544)]),c.value.length>0?(i(),m("div",Ht,[n[8]||(n[8]=e("p",{class:"font-semibold text-purple-600"},"Sugestões de foto",-1)),I(ue,{name:"fade",tag:"div",class:"grid grid-cols-3 gap-4",duration:2e3},{default:L(()=>[(i(!0),m(A,null,G(c.value,(p,d)=>(i(),m("div",{key:d,class:"cursor-pointer p-2",onClick:o=>M(p.link)},[e("img",{src:p.link,alt:p.title,class:"w-full h-24 object-cover rounded-md"},null,8,Xt)],8,Kt))),128))]),_:1})])):(i(),m("div",Zt,n[9]||(n[9]=[e("p",{class:"font-semibold text-purple-600"},"Sugestões de foto",-1),e("p",{class:"mt-3"},"Nada no momento...",-1)])))]),u.value?(i(),m("div",Yt,n[10]||(n[10]=[e("div",{class:"loader border-4 border-t-blue-500 border-gray-200 rounded-full w-12 h-12 animate-spin"},null,-1)]))):q("",!0)],32)])])):q("",!0)]))}},to=z(eo,[["__scopeId","data-v-75bf3494"]]),oo={key:0,class:"relative"},so={__name:"IconeAlerta",props:{estoque:{type:Number,required:!0},limiteMinimo:{type:Number,required:!0}},setup(a){const t=a,u=fe(()=>t.estoque<=t.limiteMinimo);return(x,l)=>u.value?(i(),m("div",oo,l[0]||(l[0]=[e("i",{class:"fa-solid fa-circle-xmark fa-xs absolute top-0 right-0 text-red-500",title:"Estoque Baixo"},null,-1)]))):q("",!0)}},ao=z(so,[["__scopeId","data-v-0e939662"]]),ro={},lo={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",style:{fill:"rgba(8, 118, 178, 1)",transform:"0",msfilter:""}};function no(a,t){return i(),m("div",null,[(i(),m("svg",lo,t[0]||(t[0]=[e("path",{d:"M20 3H4c-1.103 0-2 .897-2 2v14a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V5c0-1.103-.897-2-2-2zm-1 9h-3.142c-.446 1.722-1.997 3-3.858 3s-3.412-1.278-3.858-3H4V5h16v7h-1z"},null,-1)])))])}const io=z(ro,[["render",no]]),uo={class:"flex flex-1"},mo={class:"content-wrapper flex-1 bg-gray-100 p-4"},co={class:"content"},po={class:"container-fluid"},go={class:"row"},fo={class:"col-12"},vo={class:"text-2xl font-bold text-sky-500 flex items-center"},bo={class:"content"},yo={class:"container-fluid"},xo={class:"flex justify-between items-center"},ko={class:"flex space-x-4"},wo={class:"flex gap-2"},ho={class:"bg-white shadow-md rounded-lg p-4"},_o={class:"bg-white"},Co={class:"flex justify-between items-center gap-2"},Io=["value"],$o=["disabled"],Eo={class:"min-w-full table-auto bg-white rounded-lg shadow-lg overflow-hidden mt-4"},So={class:"bg-gray-100 border-b"},jo={class:"px-4 py-3"},qo=["onClick"],Po=["onClick"],Fo=["checked","onChange"],Vo={class:"px-6 py-4 text-sm text-gray-700 text-center flex items-center gap-2"},Mo=["src"],No={class:"px-3 py-2 text-center hidden md:table-cell"},Oo={class:"px-6 py-4 text-sm text-gray-700 text-center hidden lg:table-cell"},Ao={class:"px-6 py-4 text-sm text-gray-700 text-center hidden xl:table-cell"},Ro={class:"px-6 py-4 text-sm text-gray-700 text-center hidden xl:table-cell"},To={class:"flex justify-center gap-2 mt-4"},Jo={__name:"Index",props:{products:{type:Object,required:!0},categories:{type:Array,required:!0},filters:{type:Object,required:!0}},setup(a){const t=ee(),u=()=>t.activateComponent("produto"),x=()=>t.activateComponent("categoria"),l=a,c=v("produtos"),g=v(l.products.meta.current_page),r=v(l.products.meta.links),k=v(l.filters.search||""),h=v(l.filters.category||""),b=v([]),w=v(!1),_=v(!1),S=v(""),C=v(!1),M=v(null),R=o=>{M.value=o,_.value=!0},P=()=>{_.value=!1,M.value=null},N=async o=>{o&&Q.visit(o,{method:"get",preserveState:!1,preserveScroll:!0})},U=async()=>{Q.visit(route("produtos"),{method:"get",data:{search:k.value,category:h.value,page:g.value},preserveState:!0,preserveScroll:!0})};ve([k,h],()=>{g.value=1,U()});const y=o=>{o?b.value=l.products.data.map(s=>s.id):b.value=[]},n=o=>{b.value.includes(o)?b.value=b.value.filter(s=>s!==o):b.value.push(o)},p=()=>{if(b.value.length===0){S.value="Você precisa selecionar pelomenos 1 item se deseja excluir?",C.value=!0,w.value=!0;return}S.value=`Você tem certeza que deseja excluir ${b.value.length} item(ns)?`,C.value=!1,w.value=!0},d=async()=>{C.value||xe.Inertia.post("/produtos/excluir",{ids:b.value},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{l.products.data=l.products.data.filter(o=>!b.value.includes(o.id)),b.value=[],V.success("Item(s) Excluitdo(s)")},onError:()=>{V.error("Erro tente novamente.")}}),w.value=!1};return(o,s)=>(i(),J(ye,{title:"Produtos"},{default:L(()=>[e("div",uo,[e("div",mo,[e("section",co,[e("div",po,[e("div",go,[e("div",fo,[e("h1",vo,[I(io,{class:"h-6 w-6 mr-2"}),s[7]||(s[7]=E(" Produtos "))]),s[18]||(s[18]=e("div",{class:"mt-4"},null,-1)),e("section",bo,[e("div",yo,[e("div",xo,[e("div",ko,[e("button",{class:H(["px-4 py-3 rounded-t-lg focus:outline-none",{"bg-white text-blue-600 font-semibold":c.value==="produtos","bg-gray-100 text-gray-600":c.value!=="produtos"}]),onClick:s[0]||(s[0]=f=>c.value="produtos")}," Produtos ",2)]),e("div",wo,[e("button",{onClick:x,class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-300 hidden md:inline-block"},s[8]||(s[8]=[e("i",{class:"fa-solid fa-plus"},null,-1),E(" Nova categoria ")])),e("button",{onClick:u,class:"px-4 py-2 bg-blue-500 text-white rounded"},s[9]||(s[9]=[e("i",{class:"fa-solid fa-plus"},null,-1),E(" Novo Produto ")])),I(K,{name:"slide"},{default:L(()=>[T(t).activeComponent==="categoria"?(i(),J(to,{key:0})):q("",!0)]),_:1}),I(K,{name:"slide"},{default:L(()=>[T(t).activeComponent==="produto"?(i(),J(xt,{key:0,categories:a.categories},null,8,["categories"])):q("",!0)]),_:1})])]),e("div",ho,[e("div",_o,[e("div",Co,[$(e("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=f=>k.value=f),placeholder:"Pesquisar",class:"w-full py-2 border rounded-lg text-gray-700 focus:outline-none focus:ring"},null,512),[[O,k.value]]),$(e("select",{"onUpdate:modelValue":s[2]||(s[2]=f=>h.value=f),class:"px-4 py-2 border rounded-lg text-gray-700 focus:outline-none focus:ring"},[s[10]||(s[10]=e("option",{value:""},"Filtrar",-1)),(i(!0),m(A,null,G(l.categories,f=>(i(),m("option",{key:f.id,value:f.name},F(f.name),9,Io))),128))],512),[[Y,h.value]]),e("button",{class:H(["px-4 py-2 rounded-lg",{"bg-red-500 text-white":b.value.length>0,"bg-gray-300 text-gray-600":b.value.length===0,"cursor-not-allowed":b.value.length===0}]),disabled:b.value.length===0,onClick:p}," Ação ",10,$o),I(qe,{isOpen:w.value,isWarning:C.value,message:S.value,onCancelar:s[3]||(s[3]=f=>w.value=!1),onConfirmar:d},null,8,["isOpen","isWarning","message"])]),e("table",Eo,[e("thead",So,[e("tr",null,[e("th",jo,[e("input",{type:"checkbox",onChange:s[4]||(s[4]=f=>y(f.target.checked)),class:"cursor-pointer"},null,32)]),s[11]||(s[11]=e("th",{class:"px-6 py-4 text-center text-sm font-semibold text-gray-600 uppercase tracking-wider"}," PRODUTO ",-1)),s[12]||(s[12]=e("th",{class:"px-6 py-4 text-center text-sm font-semibold text-gray-600 uppercase tracking-wider hidden sm:table-cell"}," COD ",-1)),s[13]||(s[13]=e("th",{class:"px-6 py-4 text-center text-sm font-semibold text-gray-600 uppercase tracking-wider hidden md:table-cell"}," CATEGORIA ",-1)),s[14]||(s[14]=e("th",{class:"px-6 py-4 text-center text-sm font-semibold text-gray-600 uppercase tracking-wider hidden lg:table-cell"}," ESTOQUE ",-1)),s[15]||(s[15]=e("th",{class:"px-6 py-4 text-center text-sm font-semibold text-gray-600 uppercase tracking-wider hidden xl:table-cell"}," VALOR DE CUSTO ",-1)),s[16]||(s[16]=e("th",{class:"px-6 py-4 text-center text-sm font-semibold text-gray-600 uppercase tracking-wider hidden xl:table-cell"}," VALOR DE VENDA ",-1)),s[17]||(s[17]=e("th",{class:"px-4 py-2"},null,-1))])]),e("tbody",null,[(i(!0),m(A,null,G(l.products.data,f=>(i(),m("tr",{key:f.id,class:"cursor-pointer hover:bg-gray-50 transition-colors duration-200",onClick:j=>R(f),style:{cursor:"pointer"}},[e("td",{class:"px-6 py-4 text-sm text-gray-700 text-center relative cursor-pointer",onClick:[j=>n(f.id),s[5]||(s[5]=B(()=>{},["stop"]))]},[e("input",{type:"checkbox",checked:b.value.includes(f.id),onChange:j=>n(f.id),class:"cursor-pointer"},null,40,Fo)],8,Po),e("td",Vo,[e("img",{src:"/storage/"+(f.image_path||"default-product-image.jpg"),alt:"Produto",class:"img-circle img-50x50"},null,8,Mo),E(" "+F(f.name),1)]),e("td",{class:"px-6 py-4 text-sm text-gray-700 text-center hidden sm:table-cell",style:be({color:f.barcode===null||f.barcode===""?"cadetblue":""})},F(f.barcode||"Não informado"),5),e("td",No,F(f.category),1),e("td",Oo,[E(F(f.stock_quantity)+" ",1),I(ao,{estoque:f.stock_quantity,limiteMinimo:f.min_stock},null,8,["estoque","limiteMinimo"])]),e("td",Ao," R$ "+F(f.cost_price),1),e("td",Ro," R$ "+F(f.price),1),e("td",{class:"px-4 py-2 flex items-center gap-2",onClick:s[6]||(s[6]=B(()=>{},["stop"]))},[I(Me)])],8,qo))),128))])]),_.value?(i(),J(Ut,{key:0,produto:M.value,categories:a.categories,onClose:P},null,8,["produto","categories"])):q("",!0)]),e("div",To,[I(Ce,{links:r.value,onNavegar:N},null,8,["links"])])])])])])])])])])])]),_:1}))}};export{Jo as default};
